<!--
  To view these examples live, visit:
  http://htmlpreview.github.io/?https://raw.github.com/baconjs/bacon.js/master/examples/examples.html
 -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="../lib/jquery.js"></script>
    <script src="../lib/underscore.js"></script>
    <script src="../dist/Bacon.js"></script>
    <script>

console.log('A');

Bacon.spy(function (obs) {
    console.log('subscribing to: ' + obs);
    obs.subscribe(function () {}); // comment this line => everything works
});

var x = Bacon.sequentially(0, [1]);
// var x = Bacon.later(0, 1); // this will result in infinite error loop

x.flatMap(function () {
    console.log('inside flatMap, returning observable');
    return Bacon.never().takeUntil(x);
    // works without .takeUntil(x)
    // works with Bacon.later(0, 1) instead of Bacon.never()/Bacon.once(1)
}).log();

console.log('B');

    </script>
  </head>
  <body>
  </body>
</html>
